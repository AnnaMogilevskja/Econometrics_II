knitr::opts_chunk$set(echo = TRUE)
library(lmtest)
library(sampleSelection)
library(fixest)
library(dplyr)
library(quantreg)
library(stargazer)
# Load data
data <- read.csv("assignment1a.csv")
# Run regression
model1 <- lm(logwage ~ schooling + age + agesq, data = data)
stargazer(model1)
summary(model1)
data$work = ifelse(is.na(data$logwage), 0, 1)
heck1 = heckit(work ~ age + agesq + married + schooling + distance + subsidy,
logwage ~ age + agesq + married+ schooling + distance + subsidy, data=data)
heck2 = heckit(work ~ age + agesq + married + schooling + distance + subsidy,
logwage ~ age + agesq + schooling + distance + subsidy, data=data)
stargazer(heck1)
stargazer(heck2)
ml1 = selection(work ~ age + agesq + married + schooling + distance + subsidy,
logwage ~ age + agesq + married+ schooling + distance + subsidy, data=data)
ml2 = selection(work ~ age + agesq + married + schooling + distance + subsidy,
logwage ~ age + agesq + schooling + distance + subsidy, data=data)
stargazer(ml1)
stargazer(ml2)
summary(heck1)
summary(heck2)
heck3 = heckit(work ~ married,
logwage ~ married+ schooling, data=data)
heck3 = heckit(work ~ married + schooling,
logwage ~ married + schooling, data=data)
heck4 = heckit(work ~ married  + schooling,
logwage ~ schooling, data=data)
stargazer(heck3)
stargazer(heck4)
summary(heck3)
summary(heck4)
heck3 = heckit(work ~ married + schooling,
logwage ~ age + agesq + married + schooling, data=data)
heck4 = heckit(work ~ married  + schooling,
logwage ~ schooling, data=data)
stargazer(heck3)
stargazer(heck4)
sumamry(heck3)
summary(heck3)
heck3 = heckit(work ~ age + agesq + married + schooling,
logwage ~ age + agesq + married + schooling, data=data)
heck4 = heckit(work ~ married  + schooling,
logwage ~ schooling, data=data)
stargazer(heck3)
stargazer(heck4)
summary(heck3)
heck3 = heckit(work ~ age + agesq + married + schooling,
logwage ~ age + agesq + married + schooling, data=data)
heck4 = heckit(work ~ age + agesq + married  + schooling,
logwage ~ schooling, data=data)
stargazer(heck3)
stargazer(heck4)
summary(heck4)
heck3 = heckit(work ~ age + agesq + married + schooling,
logwage ~ age + agesq + married + schooling, data=data)
heck4 = heckit(work ~ married  + schooling,
logwage ~ age + agesq + schooling, data=data)
stargazer(heck3)
stargazer(heck4)
summary(heck4)
summary(ml1)
summary(ml2)
trial <- predict(ml1, type = "conditional" )
View(trial)
View(ml1)
ml1[2][8]
summary(coefficients(ml1))
summary(ml1 %>% coefficients())
summary(ml1)[coefficients]
summary(ml1)$coefficients
summary(ml1$coeffcients)
ml1[2]
ml1[2[2]]
ml1[2][1]
ml1$estimate[8]
beta <- ml1$estimate[8,14]
beta <- ml1$estimate[8:14]
#E[y|X,Z,w=1] = ml1$estimate[8] + ml1$estimate[9] data$age X %*% beta + rho * sigma * dnorm( Z %*% gamma ) / pnorm( Z %*% gamma )
#trial <- predict(ml1, type = "conditional" )
beta
beta <- ml1$estimate[8:14]
X <- cbind(1, data$age, data$agesq, data$married, data$schooling, data$distance, data$subsidy)
#E[y|X,Z,w=1] = ml1$estimate[8] + ml1$estimate[9] data$age X %*% beta + rho * sigma * dnorm( Z %*% gamma ) / pnorm( Z %*% gamma )
#trial <- predict(ml1, type = "conditional" )
x
X
beta <- ml1$estimate[8:14]
X <- cbind(1, data$age, data$agesq, data$married, data$schooling, data$distance, data$subsidy)
sigma <- ml1$estimate[16]
rho <- ml1$estimate[15]
#E[y|X,Z,w=1] = X %*% beta + rho * sigma * dnorm( Z %*% gamma ) / pnorm( Z %*% gamma )
#trial <- predict(ml1, type = "conditional" )
sigma
beta <- ml1$estimate[8:14]
X <- cbind(1, data$age, data$agesq, data$married, data$schooling, data$distance, data$subsidy)
sigma <- ml1$estimate[15]
rho <- ml1$estimate[16]
#E[y|X,Z,w=1] = X %*% beta + rho * sigma * dnorm( Z %*% gamma ) / pnorm( Z %*% gamma )
#trial <- predict(ml1, type = "conditional" )
sigma
rho
beta <- ml1$estimate[8:14]
X <- cbind(1, data$age, data$agesq, data$married, data$schooling, data$distance, data$subsidy)
sigma <- ml1$estimate[15]
rho <- ml1$estimate[16]
Z <- cbind(1, data$age, data$agesq, data$married, data$schooling, data$distance, data$subsidy)
gamma <- ml1$estimate[1:7]
Ystarhat = X %*% beta + rho * sigma * dnorm( Z %*% gamma ) / pnorm( Z %*% gamma )
#trial <- predict(ml1, type = "conditional" )
View(Ystarhat)
beta <- ml1$estimate[8:14]
X <- cbind(1, data$age, data$agesq, data$married, data$schooling, data$distance, data$subsidy)
sigma <- ml1$estimate[15]
rho <- ml1$estimate[16]
Z <- cbind(1, data$age, data$agesq, data$married, data$schooling, data$distance, data$subsidy)
gamma <- ml1$estimate[1:7]
Ystarhat = X %*% beta + rho * sigma * dnorm( Z %*% gamma ) / pnorm( -(Z %*% gamma) )
datanew <- cbind(data, Ystarhat)
View(datanew)
View(heck2)
heck2$coefficients
beta2 <- heck2$coefficients[8:14]
sigma2 <- heck2$coefficients[15]
rho2 <- heck2$coefficients[16]
gamma2 <- heck2$coefficients[1:7]
Z2 <- cbind(1, data$age, data$agesq, data$schooling, data$distance, data$subsidy)
Ystarhat2 = X %*% beta2 + rho2 * sigma2 * dnorm( Z2 %*% gamma2 ) / pnorm( -(Z2 %*% gamma2) )
beta2 <- heck2$coefficients[8:13]
sigma2 <- heck2$coefficients[15]
rho2 <- heck2$coefficients[16]
gamma2 <- heck2$coefficients[1:7]
X2 <- cbind(1, data$age, data$agesq, data$schooling, data$distance, data$subsidy)
Ystarhat2 = X2 %*% beta2 + rho2 * sigma2 * dnorm( Z %*% gamma2 ) / pnorm( -(Z %*% gamma2) )
datanew <- cbind(data, Ystarhat2)
View(datanew)
beta <- ml1$estimate[8:14]
X <- cbind(1, data$age, data$agesq, data$married, data$schooling, data$distance, data$subsidy)
sigma <- ml1$estimate[15]
rho <- ml1$estimate[16]
Z <- cbind(1, data$age, data$agesq, data$married, data$schooling, data$distance, data$subsidy)
gamma <- ml1$estimate[1:7]
Ystarhat = X %*% beta + rho * sigma * dnorm( Z %*% gamma ) / pnorm( -(Z %*% gamma) )
datanew <- cbind(data, Ystarhat)
beta2 <- heck2$coefficients[8:13]
sigma2 <- heck2$coefficients[15]
rho2 <- heck2$coefficients[16]
gamma2 <- heck2$coefficients[1:7]
X2 <- cbind(1, data$age, data$agesq, data$schooling, data$distance, data$subsidy)
Ystarhat2 = X2 %*% beta2 + rho2 * sigma2 * dnorm( Z %*% gamma2 ) / pnorm( -(Z %*% gamma2) )
datanew <- cbind(datanew, Ystarhat2)
View(datanew)
model2 <- lm(logwage ~ age + agesq + married + schooling + distance + subsidy, data = data)
Ystarhat3 <- predict(model2)
datanew <- cbind(datanew, Ystarhat3)
View(model2)
model2$coefficients
model2 <- lm(logwage ~ age + agesq + married + schooling + distance + subsidy, data = data)
beta3 <- model2$coefficients
Ystarhat3 = X %*% beta3
datanew <- cbind(datanew, Ystarhat3)
View(datanew)
# Plot histogramms for conditional expected log wages of unemployed individuals
df <- datanew %>% filter_at(vars(logwage),all_vars(is.na(.)))
View(df)
knitr::opts_chunk$set(echo = TRUE)
library(lmtest)
library(sampleSelection)
library(fixest)
library(dplyr)
library(quantreg)
library(stargazer)
library(ggplot2)
library(hrbrthemes)
knitr::opts_chunk$set(echo = TRUE)
library(lmtest)
library(sampleSelection)
library(fixest)
library(dplyr)
library(quantreg)
library(stargazer)
# Plot histogramms for conditional expected log wages of unemployed individuals
df <- datanew %>% filter_at(vars(logwage),all_vars(is.na(.)))
hist(datanew$Ystarhat )
hist(datanew$Ystarhat2, add=T)
hist(datanew$Ystarhat3, add=T)
# Add legend
legend("topright", legend=c("ML","Heckmann", "OLS"), col=c(rgb(1,0,0,0.5),
rgb(0,0,1,0.5)), pt.cex=2, pch=15 )
# Plot histogramms for conditional expected log wages of unemployed individuals
df <- datanew %>% filter_at(vars(logwage),all_vars(is.na(.)))
hist(datanew$Ystarhat, col=rgb(1,0,0,0.5))
hist(datanew$Ystarhat2, col=rgb(0,0,1,0.5), add=T)
hist(datanew$Ystarhat3, add=T)
# Add legend
legend("topright", legend=c("ML","Heckmann", "OLS"), col=c(rgb(1,0,0,0.5),
rgb(0,0,1,0.5)), pt.cex=2, pch=15 )
# Plot histogramms for conditional expected log wages of unemployed individuals
df <- datanew %>% filter_at(vars(logwage),all_vars(is.na(.)))
hist(datanew$Ystarhat, col=rgb(1,0,0,0.5))
hist(datanew$Ystarhat2, col=rgb(0,0,1,0.5), add=T)
hist(datanew$Ystarhat3, col=rgb(0,1,0,0.5),add=T)
# Add legend
legend("topright", legend=c("ML","Heckmann", "OLS"), col=c(rgb(1,0,0,0.5),
rgb(0,0,1,0.5), rgb(0,1,0,0.5)), pt.cex=2, pch=15 )
par(
mfrow=c(1,2),
mar=c(4,4,1,0)
)
hist(datanew$Ystarhat, col=rgb(1,0,0,0.5))
hist(datanew$Ystarhat2, col=rgb(0,0,1,0.5))
hist(datanew$Ystarhat3, col=rgb(0,1,0,0.5))
par(
mfrow=c(1,3),
mar=c(4,4,1,0)
)
hist(datanew$Ystarhat, col=rgb(1,0,0,0.5))
hist(datanew$Ystarhat2, col=rgb(0,0,1,0.5))
hist(datanew$Ystarhat3, col=rgb(0,1,0,0.5))
par(
mfrow=c(1,3),
mar=c(4,4,1,0)
)
hist(datanew$Ystarhat, col=rgb(1,0,0,0.5), main="ML" )
hist(datanew$Ystarhat2, col=rgb(0,0,1,0.5), main="Hackmann" )
hist(datanew$Ystarhat3, col=rgb(0,1,0,0.5), main="OLS" )
par(
mfrow=c(1,3),
mar=c(4,4,1,0)
)
hist(datanew$Ystarhat, col=rgb(1,0,0,0.5),xlab="Ystarhat", main="ML" )
hist(datanew$Ystarhat2, col=rgb(0,0,1,0.5),xlab="Ystarhat2", main="Hackmann" )
hist(datanew$Ystarhat3, col=rgb(0,1,0,0.5),xlab="Ystarhat3", main="OLS" )
knitr::opts_chunk$set(echo = TRUE)
library(lmtest)
library(sampleSelection)
library(fixest)
library(dplyr)
library(quantreg)
library(stargazer)
# Run regression
model1 <- lm(logwage ~ schooling + age + agesq, data = data)
stargazer(model1)
# Load data
data2 <- read.csv("assignment1b.csv")
#index1 <- which(abs)
#plot(data2$lntotexp)
#abline(v = quantile(data2$lntotexp), col="red", lwd=3, lty=2)
qqplot(data2$lntotexp, data)
View(data2)
#index1 <- which(abs)
#plot(data2$lntotexp)
#abline(v = quantile(data2$lntotexp), col="red", lwd=3, lty=2)
qqplot(data2$lntotexp, data2)
index1 <- which(abs)
plot(data2$lntotexp)
#abline(v = quantile(data2$lntotexp), col="red", lwd=3, lty=2)
x = data2$lntotexp
n = length(x)
plot((1:n - 1)/(n - 1), sort(x), type="l",
main = "Quantiles for log of total medical expenditure",
xlab = "Sample Fraction",
ylab = "Sample Quantile")
x = data2$lntotexp
n = length(x)
plot((1:n - 1)/(n - 1), sort(x), type="l",
main = "Quantiles for log of total medical expenditure",
xlab = "Sample Fraction",
ylab = "Sample Quantile")
abline(v=c(0.1,0.5,0.9))
x = data2$lntotexp
n = length(x)
plot((1:n - 1)/(n - 1), sort(x), type="l",
main = "Quantiles for log of total medical expenditure",
xlab = "Sample Fraction",
ylab = "Sample Quantile")
abline(v=c(0.1,0.5,0.9),col="blue")
ols <-lm(lntotexp~ totchr + suppins + age + female + white, data = data2)
qr <- rq(lntotexp~ totchr + suppins + age + female + white, data = data2, tau = c(0.1, 0.25, 0.5, 0.75, 0.9))
summary(ols)
summary(qr)
qr2 <- rq(lntotexp~ totchr + suppins + age + female + white, data = data2,  tau = seq(0.05, 0.95, by = 0.05))
plot(summary(qr2))
knitr::opts_chunk$set(echo = TRUE)
library(lmtest)
library(sampleSelection)
library(fixest)
library(dplyr)
library(quantreg)
library(stargazer)
# Load data
data <- read.csv("assignment1a.csv")
# Run regression
model1 <- lm(logwage ~ schooling + age + agesq, data = data)
stargazer(model1)
data$work = ifelse(is.na(data$logwage), 0, 1)
heck1 = heckit(work ~ age + agesq + married + schooling + distance + subsidy,
logwage ~ age + agesq + married+ schooling + distance + subsidy, data=data)
heck2 = heckit(work ~ age + agesq + married + schooling + distance + subsidy,
logwage ~ age + agesq + schooling + distance + subsidy, data=data)
stargazer(heck1)
stargazer(heck2)
heck3 = heckit(work ~ age + agesq + married + schooling,
logwage ~ age + agesq + married + schooling, data=data)
heck4 = heckit(work ~ married  + schooling,
logwage ~ age + agesq + schooling, data=data)
stargazer(heck3)
stargazer(heck4)
ml1 = selection(work ~ age + agesq + married + schooling + distance + subsidy,
logwage ~ age + agesq + married+ schooling + distance + subsidy, data=data)
ml2 = selection(work ~ age + agesq + married + schooling + distance + subsidy,
logwage ~ age + agesq + schooling + distance + subsidy, data=data)
stargazer(ml1)
stargazer(ml2)
beta <- ml1$estimate[8:14]
X <- cbind(1, data$age, data$agesq, data$married, data$schooling, data$distance, data$subsidy)
sigma <- ml1$estimate[15]
rho <- ml1$estimate[16]
Z <- cbind(1, data$age, data$agesq, data$married, data$schooling, data$distance, data$subsidy)
gamma <- ml1$estimate[1:7]
Ystarhat = X %*% beta + rho * sigma * dnorm( Z %*% gamma ) / pnorm( -(Z %*% gamma) )
datanew <- cbind(data, Ystarhat)
beta2 <- heck2$coefficients[8:13]
sigma2 <- heck2$coefficients[15]
rho2 <- heck2$coefficients[16]
gamma2 <- heck2$coefficients[1:7]
X2 <- cbind(1, data$age, data$agesq, data$schooling, data$distance, data$subsidy)
Ystarhat2 = X2 %*% beta2 + rho2 * sigma2 * dnorm( Z %*% gamma2 ) / pnorm( -(Z %*% gamma2) )
datanew <- cbind(datanew, Ystarhat2)
model2 <- lm(logwage ~ age + agesq + married + schooling + distance + subsidy, data = data)
beta3 <- model2$coefficients
Ystarhat3 = X %*% beta3
datanew <- cbind(datanew, Ystarhat3)
# Plot histogramms for conditional expected log wages of unemployed individuals
df <- datanew %>% filter_at(vars(logwage),all_vars(is.na(.)))
hist(datanew$Ystarhat, col=rgb(1,0,0,0.5))
hist(datanew$Ystarhat2, col=rgb(0,0,1,0.5), add=T)
hist(datanew$Ystarhat3, col=rgb(0,1,0,0.5),add=T)
# Add legend
legend("topright", legend=c("ML","Heckmann", "OLS"), col=c(rgb(1,0,0,0.5),
rgb(0,0,1,0.5), rgb(0,1,0,0.5)), pt.cex=2, pch=15 )
par(
mfrow=c(1,3),
mar=c(4,4,1,0)
)
hist(datanew$Ystarhat, col=rgb(1,0,0,0.5),xlab="Ystarhat", main="ML" )
hist(datanew$Ystarhat2, col=rgb(0,0,1,0.5),xlab="Ystarhat2", main="Hackmann" )
hist(datanew$Ystarhat3, col=rgb(0,1,0,0.5),xlab="Ystarhat3", main="OLS" )
par(
mfrow=c(1,3),
mar=c(4,4,1,0)
)
hist(datanew$Ystarhat, col=rgb(1,0,0,0.5),xlab="Ystarhat", main="ML" )
hist(datanew$Ystarhat2, col=rgb(0,0,1,0.5),xlab="Ystarhat2", main="Heckmann" )
hist(datanew$Ystarhat3, col=rgb(0,1,0,0.5),xlab="Ystarhat3", main="OLS" )
par(
mfrow=c(1,3),
mar=c(4,4,1,0)
)
hist(datanew$Ystarhat, col=rgb(1,0,0,0.5),xlab="Ystarhat", main="ML" )
hist(datanew$Ystarhat2, col=rgb(0,0,1,0.5),xlab="Ystarhat2", main="Heckman" )
hist(datanew$Ystarhat3, col=rgb(0,1,0,0.5),xlab="Ystarhat3", main="OLS" )
